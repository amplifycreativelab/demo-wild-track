---
import DifficultyBadge from "./DifficultyBadge.astro";
import ElevationSparkline from "./ElevationSparkline.astro";
import { Image } from "astro:assets";

interface Props {
    slug: string;
    name: string;
    difficulty: "Easy" | "Moderate" | "Hard" | "Expert";
    difficultyNote: string;
    duration: string;
    distance: string;
    elevationPoints?: number[];
    class?: string;
    image?: any;
}

const {
    slug,
    name,
    difficulty,
    difficultyNote,
    duration,
    distance,
    elevationPoints = [20, 50, 40, 70, 50, 90, 60],
    class: className,
    image,
} = Astro.props;
---

<div
    class:list={[
        "group border border-forest bg-forest flex flex-col h-full hover:border-orange/50 transition-all duration-300 relative overflow-hidden",
        className,
    ]}
>
    <!-- Background Image -->
    {
        image && (
            <div class="absolute inset-0 z-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500">
                <Image
                    src={image}
                    alt={name}
                    class="w-full h-full object-cover grayscale opacity-40 mix-blend-multiply"
                />
            </div>
        )
    }

    <!-- Topographic Motif -->
    <div
        class="absolute inset-0 opacity-5 pointer-events-none select-none overflow-hidden"
    >
        <svg viewBox="0 0 100 100" class="w-full h-full scale-150">
            <path
                d="M0,20 Q20,15 40,25 T80,20 T100,30"
                fill="none"
                stroke="white"
                stroke-width="0.5"></path>
            <path
                d="M0,40 Q30,35 50,45 T90,40 T100,50"
                fill="none"
                stroke="white"
                stroke-width="0.5"></path>
            <path
                d="M0,60 Q25,55 45,65 T85,60 T100,70"
                fill="none"
                stroke="white"
                stroke-width="0.5"></path>
        </svg>
    </div>

    <div class="p-6 flex flex-col h-full relative z-10">
        <div class="flex justify-between items-start mb-4">
            <DifficultyBadge difficulty={difficulty} note={difficultyNote} />
            <div class="text-right">
                <span
                    class="block text-[10px] text-text-muted uppercase tracking-widest leading-none mb-1"
                    >Elevation</span
                >
                <ElevationSparkline points={elevationPoints} />
            </div>
        </div>

        <h3
            class="text-2xl font-bold text-sand mb-4 group-hover:text-orange transition-colors"
        >
            {name}
        </h3>

        <div
            class="grid grid-cols-2 gap-4 border-t border-navy/30 pt-4 mt-auto"
        >
            <div>
                <span
                    class="block text-[10px] text-text-muted uppercase tracking-widest mb-1"
                    >Duration</span
                >
                <span class="text-sm font-bold text-text-primary capitalize"
                    >{duration}</span
                >
            </div>
            <div>
                <span
                    class="block text-[10px] text-text-muted uppercase tracking-widest mb-1"
                    >Distance</span
                >
                <span class="text-sm font-bold text-text-primary uppercase"
                    >{distance}</span
                >
            </div>
        </div>

        <a
            href={`${import.meta.env.BASE_URL}tours/${slug}`}
            class="mt-6 inline-flex items-center justify-between text-xs font-bold uppercase tracking-widest text-orange border-b border-orange/0 hover:border-orange transition-all py-1 w-fit group/btn"
        >
            Details
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-3 h-3 ml-2 group-hover/btn:translate-x-1 transition-transform"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="3"
                    d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</div>
